{
  "id": "task-20260206-session-1770359764938",
  "title": "Tank: Fix Morpheus review issues",
  "description": "**OpenClaw Session Task**\n\nAgent: tank\nSession: 7e629ba5-bde1-4d65-a13e-0adb54c2b708\nSpawned by: agent:tank:main\n\n---\n\n[Fri 2026-02-06 06:03 UTC] Fix the 3 critical issues Morpheus found in Mission Control. Push fixes to `tank` branch.\n\n**Location:** `/root/.openclaw/workspace/agents/tank/mission-control`\n\n**Issues to fix:**\n\n### 1. Express Route Order Bug (CRITICAL)\nIn `server/index.js`, the specific routes are defined AFTER parameterized routes, so they never get reached:\n- Line 774: `/api/resources/:id` catches \"metrics\" before line 926: `/api/resources/metrics`\n- Line 956: `/api/reviews/:id` catches \"metrics\"/\"summary\" before lines 1124/1138\n\n**Fix:** Move specific routes BEFORE parameterized routes:\n```javascript\n// SPECIFIC routes first\napp.get('/api/resources/metrics', ...)\napp.get('/api/reviews/metrics', ...)\napp.get('/api/reviews/summary', ...)\n// THEN parameterized routes\napp.get('/api/resources/:id', ...)\napp.get('/api/reviews/:id', ...)\n```\n\n### 2. Security: Credentials Exposed (CRITICAL)\nIn `server/index.js` lines 743-754, the `?includeValue=true` query param exposes secrets without auth.\n\n**Fix:** Remove the `includeValue` functionality entirely, or require a secure header.\n\n### 3. Self-Approval Flaw (CRITICAL)\nIn `server/review-manager.js` `approveReview()` method, users can approve their own submissions.\n\n**Fix:** Add check:\n```javascript\nif (review.submitter === approver || review.submitter_agent === approver) {\n    throw new Error('Cannot approve your own submission');\n}\n```\n\n**After fixing:**\n1. Test all three fixes work\n2. Create `tank` branch: `git checkout -b tank`\n3. Commit with clear message\n4. Push to origin: `git push origin tank`\n\n**Remember:** Read GIT-SECURITY-RULES.md - NEVER push to main/master.",
  "status": "REVIEW",
  "priority": "critical",
  "assignee": "agent-tank",
  "created_by": "agent:tank:main",
  "labels": [
    "openclaw",
    "auto-generated",
    "tank"
  ],
  "metadata": {
    "openclaw_session_id": "7e629ba5-bde1-4d65-a13e-0adb54c2b708",
    "openclaw_agent_name": "tank",
    "spawned_by": "agent:tank:main"
  },
  "created_at": "2026-02-06T06:36:04.940Z",
  "updated_at": "2026-02-06T06:36:07.039Z"
}